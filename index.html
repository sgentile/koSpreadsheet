<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>KoSpreadsheet</title>
        <link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.min.css"/>
        <script src="lib/jquery-1.7.2.min.js"></script>
        <script src="lib/knockout-2.1.0.debug.js"></script>
        <script src="lib/knockout.mapping-latest.js"></script>
        <script src="KoSpeadsheet.debug.js"></script>
        <script>
        	
        	$(function(){
        		var Item = function(id, name) {
				    this.id = id;
				    this.name = name;
				};
				
				var sampledata = {
					title : "Sample Table",
					columns : [
						{name: "Column A", width:"100px", textAlign: 'center'}, 
						{name: "Column B", width:"100px", textAlign: 'center'}, 
						{name: "Column C", width:"100px", textAlign: 'center'},
						{name: "Column D", width:"100px", textAlign: 'center'},
						{name: "Column E", width:"100px", textAlign: 'center'},
						{name: "Column F", width:"100px", textAlign: 'center'}
					],			
					rows: [                                                              
		               [{data:"magna", metadata:{fontWeight:"bold", fontStyle: "italic", textAlign: "right"}}, {data:"enim"}, {data:"minim"}, {data:"ipsum"}, {data:"dolor"}, {data:"sit"}],
		               [{data:"eiusmod"}, {data:"incididunt"}, {data:"labore"}, {data:"consectetur"}, {data:"adipisicing"}, {data:"elit"}]
		            ]};

				console.log(ko.mapping.fromJS(sampledata));
				myViewModel = {
					items: ko.mapping.fromJS(sampledata)
				};
    
				ko.applyBindings(myViewModel);
        	});
        </script>
    </head>
    <body>
        <h1>KoSpreadsheet Sample</h1>
 		
        <div data-bind="koSpreadsheet: { data: items }"></div>
        
        <!-- To create an empty, new table: 
        <hr/>
        <div data-bind="koSpreadsheet: { data: null }"></div>-->
        <!--or <div data-bind="koSpreadsheet: {}"></div> -->
        
        <!-- required template for koSpreadsheet -->
        <script type="text/html" id="ksTableTmpl">
        	<div style="overflow:auto">
						<table style="width:95%" class="table table-bordered table-condensed">
							<caption data-bind="text: title"></caption>
							<thead>
							  <tr>                                                
									<!-- ko foreach: columns -->
									<th class="spreadsheetHeader">                                        
										  <span data-bind="text: name">&nbsp;</span>
									</th>
									<!-- /ko -->
								</tr>
							</thead>
							<tbody data-bind="foreach: rows">
							  <tr>
									<!-- ko foreach: $data -->
									<td>
										  <div data-bind="text: data"></div>
									</td>
									<!-- /ko -->
								</tr>
							</tbody>
						</table>
					</div>
					<hr/>
					<div data-bind="text: ko.toJSON($data)"></div>
        </script>
    </body>
</html>
